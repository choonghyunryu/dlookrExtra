---
# Front cover title and subtitle. Also use in the running header thoughout the document
title: "플랫폼별 트래픽 보고서"
subtitle: "3월 실적"
# Abstract create an introduction box on the cover. Should be concise.
#If you want want a full page image just remove abstract-title and abstract from the YAML
abstract-title: 보고서 개요
abstract: "본 보고서는 **보험월렛**, **온슈어**, **홈페이지**의 3개 플랫폼을 대상으로, **2021년 3월** 기준의 통계 정보를 포함합니다. 보고서는 GA360 로그 정보를 기반으로 하였으며, 일부 데이터는 서비스 운영중에 발생하는 실적 데이터를 포함합니다. 보고서는 매월 초, Data Analytics 노드에서 제공합니다."
# Date is used in the running footer
date: "2021-04-23"
# Author are the persons creating the doc. They won't appear in the doc but will be part of the DOM.
# For the contact on the back cover, please refer to the bottom of the Rmd and ammend accordingly.
author:
   - name: Choonghyun Ryu
     affiliation: Data Scientist
     email: <antony@hanwha.com>
   - name: Contact name2
     affiliation: Job title2
     email: <contact2email@hanwha.com>

output: 
  dlookrExtra::dlookrExtra_templ_paged: 
    # Change to point to your cover file
    front_cover: img/cover.jpg
    # Try to keep as is it includes back cover UNHCR blue background and logo
    back_cover: img/hanwha_backcover.svg
    # Change to false to remove table of content
    toc: true
    # Change to true to add number in front of chapters
    number_sections: false
    # Change to true for a self-contained document, but it'll be a litte slower for Pandoc to render
    self_contained: true
# Set  toc title, default none
toc-title: Contents
# Change to false to remove list of tables
lot: true
# Set lot title, default: "List of Tables"
lot-title: "도표 목록"
# Change to false to remove list of figures
lof: true
# Set lof title, default: "List of Figures"
lof-title: "플롯 목록"
# If you include any <abbr> a list of abbreviations will be built.
# Set lof title, default: "List of Abbreviations"
loa-title: "약어 목록"
# Include footnotes direclty in the related page
paged-footnotes: true
# Turn links to footnote when printing the PDF on/off
links-to-footnotes: true
# uncomment this line to produce HTML and PDF in RStudio:
#knit: pagedown::chrome_print
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages, include=FALSE, message=FALSE, warning=FALSE}
# Load required packages for charts with UNHCR style 
library(hlireport)
library(ggplot2)
library(tidyverse)
library(unhcrdatapackage)
library(scales)
library(ragg)
#update_geom_font_defaults()
```


```{css, echo=FALSE}
.pagedjs_page:last-of-type {
  background-image: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcKICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIgogICB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM6c29kaXBvZGk9Imh0dHA6Ly9zb2RpcG9kaS5zb3VyY2Vmb3JnZS5uZXQvRFREL3NvZGlwb2RpLTAuZHRkIgogICB4bWxuczppbmtzY2FwZT0iaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvbmFtZXNwYWNlcy9pbmtzY2FwZSIKICAgaWQ9IkxheWVyXzEiCiAgIGRhdGEtbmFtZT0iTGF5ZXIgMSIKICAgdmlld0JveD0iMCAwIDUzOC41OCA3MjguNSIKICAgdmVyc2lvbj0iMS4xIgogICBzb2RpcG9kaTpkb2NuYW1lPSJoYW5od2FfYmFja2NvdmVyLnN2ZyIKICAgaW5rc2NhcGU6dmVyc2lvbj0iMS4wLjIgKGU4NmM4NzA4LCAyMDIxLTAxLTE1KSI+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhMTAzIj4KICAgIDxyZGY6UkRGPgogICAgICA8Y2M6V29yawogICAgICAgICByZGY6YWJvdXQ9IiI+CiAgICAgICAgPGRjOmZvcm1hdD5pbWFnZS9zdmcreG1sPC9kYzpmb3JtYXQ+CiAgICAgICAgPGRjOnR5cGUKICAgICAgICAgICByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIiAvPgogICAgICAgIDxkYzp0aXRsZSAvPgogICAgICA8L2NjOldvcms+CiAgICA8L3JkZjpSREY+CiAgPC9tZXRhZGF0YT4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICAgIGJvcmRlcmNvbG9yPSIjNjY2NjY2IgogICAgIGJvcmRlcm9wYWNpdHk9IjEiCiAgICAgb2JqZWN0dG9sZXJhbmNlPSIxMCIKICAgICBncmlkdG9sZXJhbmNlPSIxMCIKICAgICBndWlkZXRvbGVyYW5jZT0iMTAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjE1MDkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iMTAyNyIKICAgICBpZD0ibmFtZWR2aWV3MTAxIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTp6b29tPSIxLjM4MzY2NTEiCiAgICAgaW5rc2NhcGU6Y3g9IjEzMy43ODAzMyIKICAgICBpbmtzY2FwZTpjeT0iNDgxLjMzMDM2IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIyMTk5IgogICAgIGlua3NjYXBlOndpbmRvdy15PSIxMjEiCiAgICAgaW5rc2NhcGU6d2luZG93LW1heGltaXplZD0iMCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJMYXllcl8xIgogICAgIGlua3NjYXBlOmRvY3VtZW50LXJvdGF0aW9uPSIwIiAvPgogIDxkZWZzCiAgICAgaWQ9ImRlZnMxMiI+CiAgICA8c3R5bGUKICAgICAgIGlkPSJzdHlsZTEwIj4uY2xzLTF7ZmlsbDojMDA3MWJiO30uY2xzLTJ7ZmlsbDojZmZmO308L3N0eWxlPgogIDwvZGVmcz4KICA8cG9seWdvbgogICAgIGNsYXNzPSJjbHMtMSIKICAgICBwb2ludHM9Ijc2Ljk5IDAgNjYuNSAxMC40OSA1Ni4wMSAwIDAgMCAwIDcyOC41IDUzOC41OCA3MjguNSA1MzguNTggMCA3Ni45OSAwIgogICAgIGlkPSJwb2x5Z29uMTQiCiAgICAgc3R5bGU9ImZpbGw6I2ZmYjM4MCIgLz4KICA8dGV4dAogICAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgICAgc3R5bGU9ImZvbnQtc2l6ZToyNi42NjY3cHg7bGluZS1oZWlnaHQ6MS4yNTtmb250LWZhbWlseTpzYW5zLXNlcmlmIgogICAgIHg9IjU0LjEzOTM4MSIKICAgICB5PSI1NTguMDE3MzMiCiAgICAgaWQ9InRleHQ5MzQiPjx0c3BhbgogICAgICAgc29kaXBvZGk6cm9sZT0ibGluZSIKICAgICAgIGlkPSJ0c3BhbjkzMiIKICAgICAgIHg9IjU0LjEzOTM4MSIKICAgICAgIHk9IjU1OC4wMTczMyIKICAgICAgIHN0eWxlPSJmb250LXN0eWxlOm5vcm1hbDtmb250LXZhcmlhbnQ6bm9ybWFsO2ZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1zdHJldGNoOm5vcm1hbDtmb250LXNpemU6MjYuNjY2N3B4O2ZvbnQtZmFtaWx5OnNhbnMtc2VyaWY7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonc2Fucy1zZXJpZiBCb2xkJztmaWxsOiNmZmZmZmYiPkhhbndoYSBMaWZlPC90c3Bhbj48L3RleHQ+Cjwvc3ZnPgo=");
  background-position: 10mm 30mm;
  background-size: 190mm 257mm;
  background-repeat: no-repeat;
}
```

# Template

::: {.lead .custom-grey}
This R Markdown document includes all the necessary features and styles to create an UNHCR branded report.
:::

This specific template is using principally the Pagedown package, for all the information about the package see <https://pagedown.rbind.io/>. The template targets mainly the creation of paginated HTML reports that can be easily printed as PDF, but from one R Markdown document we can have many different outputs (see below).

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Preview paged HTML report

When you compile an R Markdown document to HTML in RStudio, RStudio will display the HTML page through a local web server, so paged.js will work in RStudio Viewer. However, when you view such pages in a real web browser, you will need a separate web server. The easiest way to preview these HTML pages in a web browser may be through the RStudio **servr** package, just type the following code in your R console and head to <http://127.0.0.1:4321/> in your browser to access the files.

```{r servr, include=TRUE, eval=FALSE}
# Load webserver to preview paged HTML 
servr::httd()
```

## Print to PDF

The easiest way to print to PDF is with Google Chrome or Chromium using the menu “Print” or by pressing Ctrl + P (or Command + P on macOS). Remember to allow background graphics to be printed.

There are also 2 other built-in ways:

1. using the function pagedown::chrome_print(). Its first argument (input) accepts a path to a local Rmd or HTML file or an URL. Google Chrome or Chromium must be installed on your system.
2. in RStudio, adding the following line in the YAML header of your Rmd file:

```{r print, include=TRUE, eval=FALSE}
knit: pagedown::chrome_print
```

With this metadata parameter, the behavior of the “Knit” button of RStudio is modified: it produces both the HTML document and the PDF with Chrome. This functionality is suitable for any R Markdown HTML output format and is mainly convenient for small documents like presentations or notes.
If chrome_print() cannot find Chrome or Chromium automatically, set the PAGEDOWN_CHROME environment variable to the path to Chrome or Chromium executable.

## YAML metadata

A lot of components such as the table of contents, list of figures, etc. can be activated, deactivated or tweaked directly in the YAML at the top of the R Markdown document. Please refer at the guidance directly added there.

See <https://pagedown.rbind.io/#miscellaneous-features> for extra information on the YAML variables of the package.

# Typography

::: {.lead .custom-grey}
Documentation and examples for typography, including global settings, headings, body text, lists, and more.
:::

The template uses **Lato**, one of the brand recommended font paired with **Arial** as a fallback (`font-family: 'Lato', Arial, sans-serif;`). **Lato** has been selected as it can easily be downloaded and added to the report automatically.

For all the coding part we needed a monospace font, so we used **Roboto mono** as it is easily accessible too.

## Inline text element syntax

Styling for common inline elements.

**Example:**

*This line rendered as italicized text.*

**This line rendered as bold text.**

***This line rendered as italicized and bold text.***

~~This line of text will be strikethrough.~~

You can use the `<u>` tag to <u>underline text</u>.

You can use the `<mark>` tag to <mark>highlight text</mark>.

This `^text or number^` rendered as ^superscript^.

```{r inline-text, include=TRUE, eval=FALSE}
*This line rendered as italicized text.*
**This line rendered as bold text.**
***This line rendered as italicized and bold text.***
~~This line of text will be strikethrough.~~
# There is no R Markdown code for underline but HTML can be entered directly.
You can use the '<u>' tag to <u>underline text</u>.
# There is no R Markdown code for mark but HTML can be entered directly.
You can use the '<mark>' tag to <mark>highlight text</mark>.
This '^text or number^' rendered as ^superscript^.
```

## Headings

All HTML headings, `<h1>` through `<h6>`, are available. To create a heading use `#` sign and include as many as the heading level (see example below).

If the table of content is active tags from `<h1>` to `<h3>` will appear in it with their respective hierarchy.

**Example:**

:::{.custom-blue}
[h1 Heading]{style="font-size: 2.5em;"}

[h2 Heading]{style="font-size: 2em;"}
:::

[h3 Heading]{style="font-size: 1.75em; font-weight: 700;"}

#### h4 Heading

##### h5 Heading

###### h6 Heading

```{r heading, include=TRUE, eval=FALSE}
# h1 Heading
## h2 Heading
### h3 Heading
#### h4 Heading
##### h5 Heading
###### h6 Heading
```

## Lead

To create subheading type of paragraph with bigger font.

**Example:**

::: {.lead}
Example of a paragraph with the `.lead` class applied
:::

```{r lead, include=TRUE, eval=FALSE}
# To apply a specific class to an element use the below R Markdown code
::: {.lead}
Example of a paragraph with the `.lead` class applied
:::
```

## Quotes

In R Markdown, quotes in a certain part of the text are indicated using a blockquote element. The greater-than sign is used for this purpose (>). The structure showed in the below examples should be maintained for better results. If other format are needed please open an issue.

**Example:**

Complete quotes including source, open and closing quote symbols.

> It is further proof that refugee movements and the broader issue of migration of populations ... is a global challenge that cannot be confined to a few countries.
>
> Filippo Grandi

Simple quote with no source nor quote symbols.

> The situation in South Sudan is far too fragile and dangerous for people to go back.

```{r quote, include=TRUE, eval=FALSE}
# Complete
> Quote text
>
> First and Last name

# Simple
> Quote text
```

## Abbreviations

A list of abbreviations is automatically built if the document contains at least one HTML `abbr` element.

For instance, if the R Markdown document contains `<abbr title="United Nations High Commissioner for Refugees">UNHCR</abbr>`, a list of abbreviations is built with the CSS definition.

**Example:**

<abbr title="The United Nations High Commissioner for Refugees">UNHCR</abbr>

```{r abbr, include=TRUE, eval=FALSE}
# There is no R Markdown code for abbreviations but HTML can be entered directly.
<abbr title="The United Nations High Commissioner for Refugees">UNHCR</abbr>
```

## Footnotes

Footnotes are added using the `^[This is a footnote]` R Markdown notation. The number will be automatically generated and the text between brackets will be added at the bottom of the footnote page.

**Example:**

This is a footnote^[Text of the footnote], it can include anything and can also be stylize UNHCR^[The **United Nations** High Commissioner for Refugees <https://www.unhcr.org/>]

```{r footnote, include=TRUE, eval=FALSE}
This is a footnote^[Text of the footnote]
UNHCR^[The **United Nations** High Commissioner for Refugees <https://www.unhcr.org/>]
```

## Lists

##### Unordered

To create an unsorted list in Markdown, you can use either the **plus sign, the hyphen or an asterisk**. All three ways produce the same result. To create sub-level list simply use **4 spaces indentation**.

**Example:**

* item 1
* item 2
    + sub-item 2.1
    + sub-item 2.2
* item 3
    + sub-item 3.1
    + sub-item 3.2

```{r unordered-list, include=TRUE, eval=FALSE}
* item 1
* item 2
    + sub-item 2.1
    + sub-item 2.2
* item 3
    + sub-item 3.1
    + sub-item 3.2
```

##### Ordered

A sorted list is generated by a **number directly followed by a period**. To create sub-level list simply use **4 spaces indentation**.

**Example:**

1. item 1
2. item 2
    1. item 2.1
    2. item 2.2
3. item 3
    1. item 3.1
    2. item 3.2

```{r ordered-list, include=TRUE, eval=FALSE}
1. item 1
2. item 2
    1. item 2.1
    2. item 2.2
3. item 3
    1. item 3.1
    2. item 3.2
```

##### Mixed

A mixed list is generated by using both the unordered and ordered symbols. To create sub-level list simply use **4 spaces indentation**.

**Example:**

1. item 1
* item 2
    1. item 2.1
    2. item 2.2
3. item 3
    * item 3.1
    * item 3.2

```{r mixed-list, include=TRUE, eval=FALSE}
1. item 1
* item 2
    1. item 2.1
    2. item 2.2
3. item 3
    * item 3.1
    * item 3.2
```


# Images, plots and tables

::: {.lead .custom-grey}
This section will provide with all the guidance to insert images, charts and tables.
:::

## Images

By default the images will take the **whole width** of the page area (max-width = 100%, 18cm inside the margins). It is important to adapt and fix the picture ratio before inserting them. There are some helper **`.class`** that can be used to have some flexibility in the layout. If none of the `.class` cover your needs you can always add some `style` directly to the element.

To add an image just use `![image-name](image-link)`. A caption can be added on the line right after the image (no extra line break). For proper styling please include the caption between `*` symbol (sign to make text *italic*).

**Example:**

![Placeholder](img/169_pics_landscape.png)
*Image caption text. &copy; UNHCR Photographer name*

```{r pics-main, include=TRUE, eval=FALSE}
# Important NOT to include an extra line break after the image
# to make sure the caption is stylized correctly
![Placeholder](img/169_pics_landscape.png)
*Image caption text. &copy; UNHCR Photographer name*
```

##### Helper classes and images

Whole width images might not always be the best option for your layout, especially with *portrait orientation* pictures. Use the `.img50` (`max-width: 50%`) or `.img75` (`max-width: 75%`) classes around the image and caption to reduce their sizes.

**Example:**

:::{.img50}
![Placeholder](img/169_pics_landscape.png)
*Image caption text. &copy; UNHCR Photographer name*
:::

```{r pics-small, include=TRUE, eval=FALSE}
:::{.img50}
![Placeholder](img/169_pics_landscape.png)
*Image caption text. &copy; UNHCR Photographer name*
:::
```

Combine it with the `.float-start` or `.float-end` classes to align the image on a specific side of the page and even have text around it.**Be careful with the use of floats** as the image and caption aren't part of the text flow anymore so all the content that follows will be placed next to it and not anymore below. Wrap both the image (+ caption) and the content you want to be next to it with the class `.clearfix` to cancel this. The content after the `<div class="clearfix">` will be back within the normal flow.

**Example:**

:::{.clearfix}
:::{.img50 .float-end}
![Placeholder](img/169_pics_landscape.png)
*Image caption text. &copy; UNHCR Photographer name*
:::

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum finibus dui eu mi tincidunt, blandit posuere tellus aliquet. Vivamus eget neque felis. Nam vitae est quis lacus aliquet maximus ut id magna. Nulla quis massa felis. Pellentesque sit amet varius felis, non lobortis orci. Aliquam sit amet arcu suscipit, porttitor sapien eget, ultricies ipsum.
:::

```{r pics-float, include=TRUE, eval=FALSE}
:::{.clearfix}
:::{.img50 .float-end}
![Placeholder](img/169_pics_landscape.png)
*Image caption text. &copy; UNHCR Photographer name*
:::
Lorem ipsum dolor sit amet, text that will be placed next to the image
:::
```

## Plots

You can also embed plots created directly in R. Please review the vignette on the `unhcr_theme` for `ggplot2` for more details on how to create chart following UNHCR brand.

If you have the List of figure activated you will need to include `fig.cap` in code chunk parameter. The text will be used for the caption itself as well as the name in the List of figure.


```{r single-line, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Total number of refugees - UNHCR Refugee Statistics", dpi=300}
# Load data from unhcrdatapackage
popdata <- unhcrdatapackage::end_year_population_totals

# Simplify data for the line chart need
ref_year <- popdata %>% 
  dplyr::group_by(Year) %>% 
  dplyr::summarise(REF = sum(REF, na.rm = TRUE)) %>% 
  dplyr::mutate(Year = as.Date(Year, format = '%Y'))

unhcr_blue <- rgb(0, 114, 188, maxColorValue = 255)
unhcr_grey <- rgb(102, 102, 102, maxColorValue = 255)
# Create plot
single_line <- ggplot2::ggplot(ref_year, aes(x = Year, y = REF)) + #Assign Year to x and REF population value to y
  geom_line(colour = unhcr_blue, size = 1) + # Define line chart color to unhcr_blue
  geom_hline(yintercept = 0, size = 1, colour = unhcr_grey) + #Add major line at 0
  labs(title = "Total number of refugees",
       subtitle = "Evolution of refugee population 1951-2020",
       caption = "Source: UNHCR Refugee Statistics") +
  scale_y_continuous(label = scales::label_number_si()) + ## Format axis number
  scale_x_date(breaks = breaks_pretty(n = 10)) + #Add axis label every 10 years
  theme(axis.title.x = element_blank(),
        axis.title.y = element_blank()) #Remove axis title in this context

single_line
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot and only show the plot itself in the report.

Unlike the images the size of the plots will be defined directly in the code chunk using the `out.width` parameter. We recommend that you use relative measure like `out.width="75%"`. You can also set the alignment of the figure in the code chunk parameter using the `fig.align` tag, where you set it to 'left', 'center' or 'right'.

```{r multi-line, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Total number of refugees and IDPs - UNHCR Refugee Statistics", dpi=300, out.width="75%", fig.align='center'}
# Simplify data for the line chart need
ref_idp_year <- popdata %>% 
  dplyr::group_by(Year) %>% 
  dplyr::summarise(REF = sum(REF, na.rm = TRUE),
                   IDP = sum(IDP, na.rm = TRUE)) %>%
  tidyr::pivot_longer(cols = c(REF, IDP), names_to = "population_type", values_to = "number_people") %>% 
  dplyr::mutate(Year = as.Date(Year, format = '%Y'))

# Create plot
multi_line <- ggplot2::ggplot(ref_idp_year, aes(x = Year, y = number_people, colour = population_type)) + #Assign Year to x and population value to y
  geom_line(size = 1) + #Define line chart color to the population type
  geom_hline(yintercept = 0, size = 1, colour = unhcr_grey) + #Add major line at 0
  labs(title = "Total number of refugees and IDPs",
       subtitle = "Evolution of refugee and IDP population from 1951 to 2020",
       caption = "Source: UNHCR Refugee Statistics") +
  ylab("Persons") +
  scale_y_continuous(label = scales::label_number_si()) + ## Format axis number
  scale_x_date(breaks = breaks_pretty(n = 10)) + #Add axis label every 10 years
  scale_color_manual(labels = c("IDPs", "Refugees"),
                     values = usecol(pal = c(unhcr_green, unhcr_blue))) + #Set color from the unhcr_pal
  unhcr_theme(grid = "Y") +
  theme(axis.title.x = element_blank(),
        axis.title.y = element_blank())

multi_line
```

## Tables

You can also embed tables. The easiest way is to use the `kable` function from the `knitr` package, that is included in the code chunks of your Rmd file. To include the UNHCR styles a class `.table` needs to be added to the `kable` declaration.

For example see the below table added simply with the `knitr::kable(data_frame_name, table.attr = "class=\"table\"", format = "html")` function, including some basic UNHCR styles. Be careful of the escape character to make sure it includes the extra "" as well as including the `format="html"` parameter.

**Example:**

```{r table-simple, echo=FALSE, message=FALSE, warning=FALSE}
ref_idp_table <- popdata %>% 
  dplyr::group_by(Year) %>% 
  dplyr::summarise(REF = sum(REF, na.rm = TRUE),
                   ASY = sum(ASY, na.rm = TRUE),
                   IDP = sum(IDP, na.rm = TRUE),
                   VDA = sum(VDA, na.rm = TRUE),
                   STA = sum(STA, na.rm = TRUE),
                   OOC = sum(OOC, na.rm = TRUE)) %>% 
  tail(5)

knitr::kable(ref_idp_table, table.attr = "class=\"table\"", format = "html")
```

There are 2 ways to edit the table: using some parameters of the **`kable`** function or by adding CSS classes to the **`table.attr`** parameter.

The `kable` function is mainly to affect the content of the table itself, like formatting numbers, changing column names or add figure caption. You can find some information on how to use it on the [bookdown page](https://bookdown.org/yihui/rmarkdown-cookbook/kable.html#customize-html-tables).

**Example:**

```{r table-kable, echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(ref_idp_table,
             table.attr = "class=\"table\"",
             format = "html",
             col.names = c('Years', 'Refugees', 'Asylum-seekers', 'IDPs',
                           'Venezuelans displaced abroad', 'Stateless persons',
                           'Others of concern'),
             format.args = list(big.mark = ",", scientific = FALSE),
             caption = "Population of concern to UNHCR for the last 5 years")
```

```{r table-kable-code, include=TRUE, eval=FALSE}
knitr::kable(ref_idp_table,
             table.attr = "class=\"table\"",
             format = "html",
             col.names = c('Years', 'Refugees', 'Asylum-seekers', 'IDPs',
                           'Venezuelans displaced abroad', 'Stateless persons',
                           'Others of concern'),
             format.args = list(big.mark = ",", scientific = FALSE),
             caption = "Population of concern to UNHCR for the last 5 years")
```

Adding CSS classes to the to the `table.attr` parameter will only affect the style of the table.

Here is the list of the available classes:

* `.table`: Apply base UNHCR style. **Mandatory!!!**
* `.table-striped`: Apply light-grey background even odd rows.
* `.table-striped-blue`: Apply light-blue background even odd rows.
* `.table-width`: To remove the default width of 100% and apply the width required by the data inside the table.
* `.table-bordered`: To apply borders all around the table and cells.
* `.table-borderless`: To remove all borders.

:::{.page-break}
:::

**Example:**

```{r table-class, echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(ref_idp_table,
             table.attr = "class=\"table table-striped-blue table-width\"",
             format = "html",
             format.args = list(big.mark = ",", scientific = FALSE),
             caption = "Population of concern to UNHCR for the last 5 years")
```

```{r table-class-code, include=TRUE, eval=FALSE}
knitr::kable(ref_idp_table,
             table.attr = "class=\"table table-striped-blue table-width\"",
             format = "html",
             format.args = list(big.mark = ",", scientific = FALSE),
             caption = "Population of concern to UNHCR for the last 5 years")
```

# Helper class

::: {.lead .custom-grey}
**A serie of CSS `.class`** to give extra flexibility to the report layout, as well as simplifying recurrent styling need.
:::

A class can be easily applied to a block of content, using the [fenced `div`s approach](https://pandoc.org/MANUAL.html#extension-fenced_divs). For more granular need you can also apply a class directly to inline content with [bracketed `span`s](https://pandoc.org/MANUAL.html#extension-bracketed_spans).

**Example:**

:::{.custom-blue}
A ut perore, ut lam simodi sinvel magnis doluptatem que est.
:::

A ut perore, ut lam simodi sinvel [magnis doluptatem]{.custom-blue} que est.

```{r helper, include=TRUE, eval=FALSE}
# Fenced divs
:::{.custom-blue}
A ut perore, ut lam simodi sinvel magnis doluptatem que est.
:::

# Bracketed spans
A ut perore, ut lam simodi sinvel [magnis doluptatem]{.custom-blue} que est.
```

## Text color

Simply add the `.custom-blue` or `.custom-grey` classes to apply UNHCR branded colors to text element. As mentioned before this can be applied both to fenced divs and inline elements.

**Example:**

This will be colored [blue]{.custom-blue} and this will be [grey]{.custom-grey}. It can even be mixed with other inline styling like **[bold]{.custom-blue}**.

```{r text-color, include=TRUE, eval=FALSE}
This will be colored [blue]{.custom-blue} and this will be [grey]{.custom-grey}.
It can even be mixed with other inline styling like **[bold]{.custom-blue}**.
```

:::{.page-break}
:::

## Background color

Easily create call out boxes by adding the backgroud helper classes. They come in light-blue (`.bg-blue`) and light-grey (`.bg-grey`). Both come with padding to allow spacing around the elements inside. These classes need to be apply **only to fenced divs element**.

**Example:**

:::{.bg-blue}
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin ultrices mauris eget ligula imperdiet tincidunt. Proin eget odio laoreet, sagittis metus a, rutrum risus. Duis in ante sed enim pharetra pulvinar. Phasellus sit amet vestibulum lorem. Aliquam tincidunt mauris sit amet pharetra viverra.
:::

<br>

:::{.bg-grey}
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin ultrices mauris eget ligula imperdiet tincidunt. Proin eget odio laoreet, sagittis metus a, rutrum risus. Duis in ante sed enim pharetra pulvinar. Phasellus sit amet vestibulum lorem. Aliquam tincidunt mauris sit amet pharetra viverra.
:::

```{r bg-color, include=TRUE, eval=FALSE}
# Blue example
:::{.bg-blue}
Lorem ipsum dolor sit amet,...
:::
  
# Grey example
:::{.bg-grey}
Lorem ipsum dolor sit amet,...
:::
```

## Columns

The **`.col2`** class create a 2 columns layout for the content inside the section comprise between the opening `:::{.col2}` and closing `:::` tags. The use is recommended **only for text**. For more complex layout including images or plots please refer to the [Floats](#floats) section for documentation or to the [Helper classes and images](#helper-classes-and-images) part for examples.

**Example:**

:::{.col2}
A ut perore, ut lam simodi sinvel magnis doluptatem que est, tem quosantis is cone ea dolessus anditas pereper sperum que sim assundebis eum fuga. Et eate litia seruntotas ideni untorro mollatis recest anisqui ilicab ipsanitio.
:::

```{r columns, include=TRUE, eval=FALSE}
:::{.col2}
A ut perore, ut lam simodi sinvel magnis doluptatem que est, tem quosantis is cone ea
dolessus anditas pereper sperum que sim assundebis eum fuga. Et eate litia seruntotas
ideni untorro mollatis recest anisqui ilicab ipsanitio.
:::
```

## Floats

These utility classes float an element to the left or right using the CSS float property. `!important` is included to avoid specificity issues.

We highly encourage you to use the `.clearfix` class to quickly and easily clear floated content within a container by adding a clearfix utility. Apply `.clearfix` to the **parent element** this will ensure the content flow is back to normal after the floating elements, see [Helper classes and images](#helper-classes-and-images) for examples.

**Example:**

:::{.clearfix}
:::{.float-start}
This will float start (left of the page).
:::

<br>

:::{.float-end}
This will float end (right of the page).
:::
:::

```{r floats, include=TRUE, eval=FALSE}
# Clearfix is needed to make sure it recreates the normal content flow
:::{.clearfix}
:::{.float-start}
This will float start (left of the page).
:::
:::
  
:::{.clearfix} 
:::{.float-end}
This will float end (right of the page).
:::
:::
```

:::{.page-break}
:::

## Page break

The template automatically creates a page break when your content doesn't fit into a page. However, you may need to control this fragmentation to avoid solitary element. Simply create a fenced div with the class `.page-break` and it will push all the following content to the next page. Avoid using the `.page-break` class alongside floating element.

**Example:**

```{r page-break, include=TRUE, eval=FALSE}
# Create an empty div thet will push all following content to the next page.
:::{.page-break}
:::
```

::: {.back-cover}

::: {.back-header}
<h1 class="back-title"></h1>
<h1 class="back-subtitle"></h1>
:::

::: {.back-footer}
For more information please contact:

::: {.back-contact}
[Contact1 Name]{.back-name}

Contact1 Title

[email1@unhcr.org](mailto:email1@hanwha.com)
:::

::: {.back-contact}
[Contact2 Name]{.back-name}

Contact2 Title

[email2@unhcr.org](mailto:email2@hanwha.com)
:::

:::

:::



